import { Component, OnInit } from '@angular/core';
import { Router } from '@angular/router';
import { ServiceAuthentificationService } from '../Service/service-authentification.service';

//______________________________________________________________________________________________________________________________________________________________________



//______________________________________________________________________________________________________________________________________________________________________


@Component({
  selector: 'app-connexion',
  templateUrl: './connexion.component.html',
  styleUrls: ['./connexion.component.scss']
})
export class ConnexionComponent implements OnInit {

//______________________________________________________________________________________________________________________________________________________________________



//______________________________________________________________________________________________________________________________________________________________________

  constructor(private _service: ServiceAuthentificationService, private route: Router) {
    
  }

//______________________________________________________________________________________________________________________________________________________________________

	
//______________________________________________________________________________________________________________________________________________________________________

	

//______________________________________________________________________________________________________________________________________________________________________

  ngOnInit(): void {
    if(this._service.IsUser()==true){
      this.route.navigate(["/**"])

    }

  }

//______________________________________________________________________________________________________________________________________________________________________


  isUser(){
    return this._service.IsUser()
  }
  //______________________________________________________________________________________________________________________________________________________________________


  token: any

//______________________________________________________________________________________________________________________________________________________________________


  public User = {
    Email: "",
    Mot_De_Pass: ""
  }

//______________________________________________________________________________________________________________________________________________________________________


  Connexion() {

    this._service.connexionEt(this.User).subscribe(
      (res) => {
        this.token = res
        localStorage.setItem("token", this.token.MyToken)
        let data = this._service.GetDataProfile() 
        let identifiant = data.id
        this.route.navigate(["/Etudiant"]);
      }, () => {
        this._service.connexionEn(this.User).subscribe(
          (res) => {
            this.token = res
            localStorage.setItem("token", this.token.MyToken)
            let data = this._service.GetDataProfile() 
            let identifiant = data.id
            this.route.navigate(["/Enseignant"]);
          }, () => {
            alert("Email or Password Incorrect !")
          })})
          
  }

//______________________________________________________________________________________________________________________________________________________________________


//______________________________________________________________________________________________________________________________________________________________________

//______________________________________________________________________________________________________________________________________________________________________


//______________________________________________________________________________________________________________________________________________________________________

//______________________________________________________________________________________________________________________________________________________________________


//______________________________________________________________________________________________________________________________________________________________________

//______________________________________________________________________________________________________________________________________________________________________

//______________________________________________________________________________________________________________________________________________________________________

//______________________________________________________________________________________________________________________________________________________________________

//______________________________________________________________________________________________________________________________________________________________________

//______________________________________________________________________________________________________________________________________________________________________



//______________________________________________________________________________________________________________________________________________________________________

}
